{"version":3,"sources":["routes/Course/Lessons/PerCourseComment/components/index.js"],"names":["Header","Content","Footer","TextArea","Sider","antd_lib_input__WEBPACK_IMPORTED_MODULE_23___default","a","Editor","_ref","onChange","onSubmit","submitting","value","react__WEBPACK_IMPORTED_MODULE_26___default","createElement","antd_lib_form__WEBPACK_IMPORTED_MODULE_21___default","Item","rows","antd_lib_button__WEBPACK_IMPORTED_MODULE_19___default","htmlType","loading","onClick","type","style","float","PerComment","connect","state","commentInfo","visible","isMobile","componentDidMount","_this","judgeIsMobile","getComment","unregisterEnquire","enquireIsMobile","ismobile","setState","goBack","history","replace","addTopic","data","topicPercourseId","$$","getStore","topicContent","post","then","resp","icon","antd_lib_message__WEBPACK_IMPORTED_MODULE_11___default","success","message","error","handleClick","closeComment","handleSubmit","setTimeout","Object","D_reactProject_itsp_tmp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_17__","handleChange","e","target","_this2","this","get","concat","catch","console","log","_this3","_this$state","antd_lib_layout__WEBPACK_IMPORTED_MODULE_25___default","className","color","antd_lib_menu__WEBPACK_IMPORTED_MODULE_7___default","theme","mode","lineHeight","antd_lib_icon__WEBPACK_IMPORTED_MODULE_9___default","fontSize","marginLeft","marginTop","padding","antd_lib_list__WEBPACK_IMPORTED_MODULE_3___default","itemLayout","dataSource","renderItem","item","Meta","avatar","antd_lib_avatar__WEBPACK_IMPORTED_MODULE_5___default","src","userImg","title","href","_","setStore","topicId","push","description","topicCreatedTime","antd_lib_comment__WEBPACK_IMPORTED_MODULE_1___default","alt","content","textAlign","BaseComponent"],"mappings":"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","file":"static/js/14.16cae499.chunk.js","sourcesContent":["import React from 'react';\nimport {connect} from 'dva';\nimport {Layout, Icon, Menu, message, Comment, Avatar, List, Divider, Form, Input, Button} from 'antd';\nimport BaseComponent from 'components/BaseComponent';\nimport $$ from 'cmn-utils'\nimport './index.less'\nimport {enquireIsMobile} from '@/utils/enquireScreen';\n\nconst {Header, Content, Footer, Sider} = Layout;\nconst TextArea = Input.TextArea\n//定义发布主题的UI\nconst Editor = ({\n                  onChange, onSubmit, submitting, value,\n                }) => (\n  <div>\n    <Form.Item>\n      <TextArea rows={4} onChange={onChange} value={value}/>\n    </Form.Item>\n    <Form.Item>\n      <Button\n        htmlType=\"submit\"\n        loading={submitting}\n        onClick={onSubmit}\n        type=\"primary\"\n        style={{float: 'right'}}\n      >\n        添加留言\n      </Button>\n    </Form.Item>\n  </div>\n)\n\n@connect()  //dva connect\nexport default class PerComment extends BaseComponent {\n  state = {\n    commentInfo: [],\n    visible: false,\n    submitting: false,\n    value: '',\n    isMobile: false\n  }\n\n  componentDidMount = () => {\n    this.judgeIsMobile()\n    this.getComment()\n  }\n\n  //判断是否是手机\n  judgeIsMobile = () => {\n    this.unregisterEnquire = enquireIsMobile(ismobile => {\n      const {isMobile} = this.state;\n      if (isMobile !== ismobile) {\n        this.setState({\n          isMobile: ismobile\n        });\n      }\n    });\n  }\n\n  //获取指定课程评论\n  getComment() {\n    $$.get(`http://59.67.107.169:8010/api/topic/queryByPerCourseId/${$$.getStore('perCourseId')}`)\n      .then(resp =>\n        this.setState({\n          commentInfo: resp.data\n        })).catch(e => console.log(e))\n  }\n\n  //返回课程详情页\n  goBack = () => {\n    this.history.replace('/column/intro')\n  }\n\n  //新建课程评论\n  addTopic = () => {\n    let data = {\n      topicPercourseId: $$.getStore('perCourseId'),\n      topicContent: this.state.value\n    }\n    $$.post(`http://59.67.107.169:8010/api/topic/publicTopic`, data).then(\n      resp => {\n        if (resp.icon === 'success') {\n          message.success(resp.message)\n        } else {\n          message.error(resp.message)\n        }\n      }\n    )\n  }\n\n  //按钮点击回调\n  handleClick = () => {\n    this.setState({visible: true})\n  }\n  //关闭回复\n  closeComment = () => {\n    this.setState({visible: false})\n  }\n  //提交评论\n  handleSubmit = () => {\n    if (!this.state.value) {\n      return;\n    }\n    this.setState({\n      submitting: true,\n    });\n\n    //更新回复内容\n    this.addTopic()\n\n    setTimeout(() => {\n      this.setState({\n        submitting: false,\n        value: ''\n      })\n\n      this.getComment()\n      //关闭评论编辑框\n      this.closeComment(this)\n    }, 1000);\n  }\n\n  //提交修改\n  handleChange = (e) => {\n    this.setState({\n      value: e.target.value,\n    });\n  }\n\n  render() {\n    const {commentInfo, submitting, value, visible, isMobile} = this.state\n\n    return (\n      <Layout className=\"full-layout per-comment-page\">\n        <Header style={{color: 'black'}}>\n          <Menu\n            theme=\"dark\"\n            mode=\"horizontal\"\n            style={{lineHeight: '64px'}}\n          >\n            <Menu.Item>\n              <div onClick={this.goBack}>\n                <Icon type=\"arrow-left\"\n                      style={isMobile ? {color: 'white', fontSize: '25px', } :{color: 'white', fontSize: '25px', marginLeft: '50px', marginTop: '10px'}}/>\n                返回课程主页\n              </div>\n            </Menu.Item>\n          </Menu>\n        </Header>\n        <Content style={{padding: '20px 50px'}}>\n          <div>\n            {commentInfo === null ? <div style={{marginLeft: '20px'}}>暂时没有评论</div> :\n              <List\n                itemLayout='horizontal'\n                dataSource={commentInfo}\n                renderItem={item => (\n                  <List.Item>\n                    <List.Item.Meta\n                      avatar={<Avatar\n                        src={item.userImg}/>}\n                      title={\n                        <a href=\"javascript:;\" onClick={_ => {\n                          $$.setStore('topicId', item.topicId)\n                          $$.setStore('beforeUrl', '/column/per/comment')\n                          this.history.push('/column/per/community/intro')\n                        }}>\n                          {item.topicContent}\n                        </a>\n                      }\n                      description={item.topicCreatedTime}\n                    />\n                  </List.Item>\n                )}\n              />\n            }\n            {visible &&\n            <Comment\n              avatar={(\n                <Avatar\n                  src=\"http://localhost:8010/file/icon1.jpeg\"\n                  alt=\"Shang Yuxiu\"\n                />\n              )}\n              content={(\n                <Editor\n                  onChange={this.handleChange}\n                  onSubmit={this.handleSubmit}\n                  submitting={submitting}\n                  value={value}\n                />\n              )}\n            />\n            }\n            <Button type=\"primary\" icon='plus' style={{marginTop: '40px'}} onClick={this.handleClick}>\n              发布课程留言\n            </Button>\n          </div>\n        </Content>\n        <Footer style={{textAlign: 'center'}}></Footer>\n      </Layout>\n    );\n  }\n}\n"],"sourceRoot":""}
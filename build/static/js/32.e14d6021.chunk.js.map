{"version":3,"sources":["routes/Community/TopicIntro/components/index.js"],"names":["Header","Content","TextArea","antd_lib_input__WEBPACK_IMPORTED_MODULE_23___default","a","Editor","_ref","onChange","onSubmit","submitting","value","react__WEBPACK_IMPORTED_MODULE_26___default","createElement","antd_lib_form__WEBPACK_IMPORTED_MODULE_21___default","Item","rows","antd_lib_button__WEBPACK_IMPORTED_MODULE_19___default","htmlType","loading","onClick","type","style","float","TopicIntro","connect","_ref2","topicIntro","models","state","visible","comments","isMobile","componentDidMount","_this","getOneComment","judgeIsMobile","unregisterEnquire","enquireIsMobile","ismobile","setState","props","dispatch","afterResponse","resp","data","payload","valueField","method","url","concat","$$","getStore","addComment","icon","antd_lib_message__WEBPACK_IMPORTED_MODULE_11___default","success","message","erro","replyTopicId","replyUserId","userId","replyContent","goBack","history","push","replyComment","closeComment","handleSubmit","setTimeout","Object","D_reactProject_itsp_tmp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_17__","handleChange","e","target","_this$state","this","topicDetail","antd_lib_layout__WEBPACK_IMPORTED_MODULE_25___default","className","color","antd_lib_menu__WEBPACK_IMPORTED_MODULE_7___default","theme","mode","lineHeight","antd_lib_icon__WEBPACK_IMPORTED_MODULE_9___default","fontSize","marginLeft","marginTop","padding","antd_lib_comment__WEBPACK_IMPORTED_MODULE_3___default","actions","author","topicUserId","avatar","antd_lib_avatar__WEBPACK_IMPORTED_MODULE_5___default","src","userImg","content","topicContent","datetime","topicCreatedTime","antd_lib_list__WEBPACK_IMPORTED_MODULE_1___default","dataSource","replyList","itemLayout","renderItem","item","replyCreatedTime","borderBottom","alt","userName","BaseComponent"],"mappings":"mgBAOOA,aAAQC,cACTC,EAAWC,EAAAC,EAAMF,SAGjBG,EAAS,SAAAC,GAAA,IACGC,EADHD,EACGC,SAAUC,EADbF,EACaE,SAAUC,EADvBH,EACuBG,WAAYC,EADnCJ,EACmCI,MADnC,OAGbC,EAAAP,EAAAQ,cAAA,WACED,EAAAP,EAAAQ,cAAAC,EAAAT,EAAMU,KAAN,KACEH,EAAAP,EAAAQ,cAACV,EAAD,CAAUa,KAAM,EAAGR,SAAUA,EAAUG,MAAOA,KAEhDC,EAAAP,EAAAQ,cAAAC,EAAAT,EAAMU,KAAN,KACEH,EAAAP,EAAAQ,cAAAI,EAAAZ,EAAA,CACEa,SAAS,SACTC,QAAST,EACTU,QAASX,EACTY,KAAK,UACLC,MAAO,CAACC,MAAO,UALjB,+BAiBeC,EAJpBC,kBAAQ,SAAAC,GAAA,MAA4B,CACnCC,WADOD,EAAEC,WAETR,QAFOO,EAAcP,QAEJS,OAAOD,2NAIxBE,MAAQ,CACNC,SAAS,EACTC,SAAU,GACVrB,YAAY,EACZC,MAAO,GACPqB,UAAU,KAGZC,kBAAoB,WAClBC,EAAKC,gBACLD,EAAKE,mBAIPA,cAAgB,WACdF,EAAKG,kBAAoBC,YAAgB,SAAAC,GACpBL,EAAKL,MAAjBG,WACUO,GACfL,EAAKM,SAAS,CACZR,SAAUO,SAOlBJ,cAAgB,WACdD,EAAKO,MAAMC,SAAS,CAClBrB,KAAM,sBACNsB,cAAe,SAAAC,GAAI,OAAIA,EAAKC,MAC5BC,QAAS,CACPC,WAAY,cACZC,OAAQ,MACRC,IAAG,mDAAAC,OAAqDC,IAAGC,SAAS,kBAM1EC,WAAa,WACXnB,EAAKO,MAAMC,SAAS,CAClBrB,KAAM,sBACNsB,cAAe,SAAAC,GACK,YAAdA,EAAKU,KACPC,EAAAlD,EAAQmD,QAAQZ,EAAKa,SAErBF,EAAAlD,EAAQqD,KAAKd,EAAKa,UAGtBX,QAAS,CACPE,OAAQ,OACRC,IAAG,mDACHJ,KAAM,CACJc,aAAcR,IAAGC,SAAS,WAC1BQ,YAAaT,IAAGC,SAAS,QAAQS,OACjCC,aAAc5B,EAAKL,MAAMlB,aAOjCoD,OAAS,WACP7B,EAAK8B,QAAQC,KAAKd,IAAGC,SAAS,iBAGhCc,aAAe,WACbhC,EAAKM,SAAS,CACZV,SAAS,OAKbqC,aAAe,WACbjC,EAAKM,SAAS,CAACV,SAAS,OAG1BsC,aAAe,WACRlC,EAAKL,MAAMlB,QAIhBuB,EAAKM,SAAS,CACZ9B,YAAY,IAIdwB,EAAKmB,aAELgB,WAAW,WACTnC,EAAKM,SAAS,CACZ9B,YAAY,EACZC,MAAO,KAETuB,EAAKC,gBAELD,EAAKiC,aAALG,OAAAC,EAAA,EAAAD,QAAAC,EAAA,EAAAD,CAAApC,MACC,SAILsC,aAAe,SAACC,GACdvC,EAAKM,SAAS,CACZ7B,MAAO8D,EAAEC,OAAO/D,iFAIX,IAAAgE,EACkDC,KAAK/C,MAAvDC,EADA6C,EACA7C,QAAmBpB,GADnBiE,EACS5C,SADT4C,EACmBjE,YAAYC,EAD/BgE,EAC+BhE,MAAOqB,EADtC2C,EACsC3C,SACtC6C,EAAeD,KAAKnC,MAAMd,WAA1BkD,YACP,OACEjE,EAAAP,EAAAQ,cAAAiE,EAAAzE,EAAA,CAAQ0E,UAAU,gCAChBnE,EAAAP,EAAAQ,cAACZ,EAAD,CAAQqB,MAAO,CAAC0D,MAAO,UACrBpE,EAAAP,EAAAQ,cAAAoE,EAAA5E,EAAA,CACE6E,MAAM,OACNC,KAAK,aACL7D,MAAO,CAAC8D,WAAY,SAEpBxE,EAAAP,EAAAQ,cAAAoE,EAAA5E,EAAMU,KAAN,KACEH,EAAAP,EAAAQ,cAAA,OAAKO,QAASwD,KAAKb,QACjBnD,EAAAP,EAAAQ,cAAAwE,EAAAhF,EAAA,CAAMgB,KAAK,aACLC,MAAOU,EAAW,CAACgD,MAAO,QAASM,SAAU,QAAW,CAACN,MAAO,QAASM,SAAU,OAAQC,WAAY,OAAQC,UAAW,UAFlI,2CAQN5E,EAAAP,EAAAQ,cAACX,EAAD,CAASoB,MAAO,CAACmE,QAAS,cACxB7E,EAAAP,EAAAQ,cAAA6E,EAAArF,EAAA,CACE0E,UAAU,gBACVY,QAAS,CAAC/E,EAAAP,EAAAQ,cAAA,OAAKO,QAASwD,KAAKV,cAAnB,iBACV0B,OAAQf,EAAYgB,YACpBC,OACElF,EAAAP,EAAAQ,cAAAkF,EAAA1F,EAAA,CACE2F,IAAKnB,EAAYoB,UAErBC,QAASrB,EAAYsB,aACrBC,SAAUvB,EAAYwB,kBAEtBzF,EAAAP,EAAAQ,cAAA,WACED,EAAAP,EAAAQ,cAAAyF,EAAAjG,EAAA,CACEkG,WAAY1B,EAAY2B,UACxBC,WAAW,aACX1B,UAAU,eACV2B,WAAY,SAAAC,GAAI,OACd/F,EAAAP,EAAAQ,cAAA6E,EAAArF,EAAA,CAEEuF,OAAQe,EAAK/C,YACbkC,OACElF,EAAAP,EAAAQ,cAAAkF,EAAA1F,EAAA,CACE2F,IAAK7C,IAAGC,SAAS,QAAQ6C,UAE7BC,QAASS,EAAK7C,aACdsC,SAAUO,EAAKC,iBACftF,MAAO,CAACuF,aAAc,0BAI3B/E,GACClB,EAAAP,EAAAQ,cAAA6E,EAAArF,EAAA,CACEyF,OACElF,EAAAP,EAAAQ,cAAAkF,EAAA1F,EAAA,CACE2F,IAAK7C,IAAGC,SAAS,QAAQ6C,QACzBa,IAAK3D,IAAGC,SAAS,QAAQ2D,WAG7Bb,QACEtF,EAAAP,EAAAQ,cAACP,EAAD,CACEE,SAAUoE,KAAKJ,aACf/D,SAAUmE,KAAKR,aACf1D,WAAYA,EACZC,MAAOA,iBA7KWqG","file":"static/js/32.e14d6021.chunk.js","sourcesContent":["import React from 'react';\r\nimport {connect} from 'dva';\r\nimport {Avatar, Form, Comment, Icon, Layout, List, Menu, Button, Input, message} from 'antd';\r\nimport BaseComponent from 'components/BaseComponent'\r\nimport {enquireIsMobile} from '@/utils/enquireScreen';\r\nimport $$ from 'cmn-utils'\r\n\r\nconst {Header, Content} = Layout;\r\nconst TextArea = Input.TextArea\r\n\r\n//定义添加回复UI\r\nconst Editor = ({\r\n                  onChange, onSubmit, submitting, value,\r\n                }) => (\r\n  <div>\r\n    <Form.Item>\r\n      <TextArea rows={4} onChange={onChange} value={value}/>\r\n    </Form.Item>\r\n    <Form.Item>\r\n      <Button\r\n        htmlType=\"submit\"\r\n        loading={submitting}\r\n        onClick={onSubmit}\r\n        type=\"primary\"\r\n        style={{float: 'right'}}\r\n      >\r\n        添加留言\r\n      </Button>\r\n    </Form.Item>\r\n  </div>\r\n)\r\n\r\n@connect(({topicIntro, loading}) => ({\r\n  topicIntro,\r\n  loading: loading.models.topicIntro\r\n}))\r\nexport default class TopicIntro extends BaseComponent {\r\n\r\n  state = {\r\n    visible: false,\r\n    comments: [],\r\n    submitting: false,\r\n    value: '',\r\n    isMobile: false\r\n  }\r\n\r\n  componentDidMount = () => {\r\n    this.getOneComment()\r\n    this.judgeIsMobile()\r\n  }\r\n\r\n  //判断是否是手机\r\n  judgeIsMobile = () => {\r\n    this.unregisterEnquire = enquireIsMobile(ismobile => {\r\n      const {isMobile} = this.state;\r\n      if (isMobile !== ismobile) {\r\n        this.setState({\r\n          isMobile: ismobile\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  //获取指定的评论信息\r\n  getOneComment = () => {\r\n    this.props.dispatch({\r\n      type: 'topicIntro/@request',\r\n      afterResponse: resp => resp.data,\r\n      payload: {\r\n        valueField: 'topicDetail',\r\n        method: 'GET',\r\n        url: `http://192.168.43.191:8010/api/topic/queryTopic/${$$.getStore('topicId')}`\r\n      }\r\n    })\r\n  }\r\n\r\n  //添加回复内容\r\n  addComment = () => {\r\n    this.props.dispatch({\r\n      type: 'topicIntro/@request',\r\n      afterResponse: resp => {\r\n        if (resp.icon === 'success') {\r\n          message.success(resp.message)\r\n        } else {\r\n          message.erro(resp.message)\r\n        }\r\n      },\r\n      payload: {\r\n        method: 'POST',\r\n        url: `http://192.168.43.191:8010/api/reply/publicReply`,\r\n        data: {\r\n          replyTopicId: $$.getStore('topicId'),\r\n          replyUserId: $$.getStore('user').userId,\r\n          replyContent: this.state.value\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  //返回\r\n  goBack = () => {\r\n    this.history.push($$.getStore('beforeUrl'))\r\n  }\r\n  //回复评论\r\n  replyComment = () => {\r\n    this.setState({\r\n      visible: true\r\n    })\r\n  }\r\n\r\n  //关闭回复\r\n  closeComment = () => {\r\n    this.setState({visible: false})\r\n  }\r\n  //提交评论\r\n  handleSubmit = () => {\r\n    if (!this.state.value) {\r\n      return;\r\n    }\r\n\r\n    this.setState({\r\n      submitting: true,\r\n    });\r\n\r\n    //更新回复内容\r\n    this.addComment()\r\n\r\n    setTimeout(() => {\r\n      this.setState({\r\n        submitting: false,\r\n        value: ''\r\n      })\r\n      this.getOneComment()\r\n      //关闭评论编辑框\r\n      this.closeComment(this)\r\n    }, 1000);\r\n  }\r\n\r\n  //提交修改\r\n  handleChange = (e) => {\r\n    this.setState({\r\n      value: e.target.value,\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const {visible, comments, submitting, value, isMobile} = this.state\r\n    const {topicDetail} = this.props.topicIntro\r\n    return (\r\n      <Layout className=\"full-layout topic-intro-page\">\r\n        <Header style={{color: 'black'}}>\r\n          <Menu\r\n            theme=\"dark\"\r\n            mode=\"horizontal\"\r\n            style={{lineHeight: '64px'}}\r\n          >\r\n            <Menu.Item>\r\n              <div onClick={this.goBack}>\r\n                <Icon type=\"arrow-left\"\r\n                      style={isMobile ? {color: 'white', fontSize: '25px', } :{color: 'white', fontSize: '25px', marginLeft: '50px', marginTop: '10px'}}/>\r\n                返回评论主页\r\n              </div>\r\n            </Menu.Item>\r\n          </Menu>\r\n        </Header>\r\n        <Content style={{padding: '20px 50px'}}>\r\n          <Comment\r\n            className=\"comment-topic\"\r\n            actions={[<div onClick={this.replyComment}>回复</div>]}\r\n            author={topicDetail.topicUserId}\r\n            avatar={(\r\n              <Avatar\r\n                src={topicDetail.userImg}\r\n              />)}\r\n            content={topicDetail.topicContent}\r\n            datetime={topicDetail.topicCreatedTime}\r\n          >\r\n            <div>\r\n              <List\r\n                dataSource={topicDetail.replyList}\r\n                itemLayout=\"horizontal\"\r\n                className=\"comment-list\"\r\n                renderItem={item => (\r\n                  <Comment\r\n                    // actions={[<div onClick={this.openComment}>回复</div>]}\r\n                    author={item.replyUserId}\r\n                    avatar={(\r\n                      <Avatar\r\n                        src={$$.getStore('user').userImg}\r\n                      />)}\r\n                    content={item.replyContent}\r\n                    datetime={item.replyCreatedTime}\r\n                    style={{borderBottom: '1px solid #e2e2e2'}}\r\n                  />\r\n                )}\r\n              />\r\n              {visible &&\r\n                <Comment\r\n                  avatar={(\r\n                    <Avatar\r\n                      src={$$.getStore('user').userImg}\r\n                      alt={$$.getStore('user').userName}\r\n                    />\r\n                  )}\r\n                  content={(\r\n                    <Editor\r\n                      onChange={this.handleChange}\r\n                      onSubmit={this.handleSubmit}\r\n                      submitting={submitting}\r\n                      value={value}\r\n                    />\r\n                  )}\r\n                />\r\n              }\r\n            </div>\r\n          </Comment>\r\n        </Content>\r\n      </Layout>\r\n    );\r\n  }\r\n}\r\n"],"sourceRoot":""}
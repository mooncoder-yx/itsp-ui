{"version":3,"sources":["routes/Course/Lessons/PerCourseComment/components/index.js"],"names":["Header","Content","Footer","TextArea","Sider","antd_lib_input__WEBPACK_IMPORTED_MODULE_23___default","a","Editor","_ref","onChange","onSubmit","submitting","value","react__WEBPACK_IMPORTED_MODULE_26___default","createElement","antd_lib_form__WEBPACK_IMPORTED_MODULE_21___default","Item","rows","antd_lib_button__WEBPACK_IMPORTED_MODULE_19___default","htmlType","loading","onClick","type","style","float","PerComment","connect","state","commentInfo","visible","isMobile","componentDidMount","_this","judgeIsMobile","getComment","unregisterEnquire","enquireIsMobile","ismobile","setState","goBack","history","replace","addTopic","data","topicPercourseId","$$","getStore","topicContent","post","then","resp","icon","antd_lib_message__WEBPACK_IMPORTED_MODULE_11___default","success","message","error","handleClick","closeComment","handleSubmit","setTimeout","Object","D_reactProject_itsp_tmp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_17__","handleChange","e","target","_this2","this","get","concat","catch","console","log","_this3","_this$state","antd_lib_layout__WEBPACK_IMPORTED_MODULE_25___default","className","color","antd_lib_menu__WEBPACK_IMPORTED_MODULE_7___default","theme","mode","lineHeight","antd_lib_icon__WEBPACK_IMPORTED_MODULE_9___default","fontSize","marginLeft","marginTop","padding","antd_lib_list__WEBPACK_IMPORTED_MODULE_3___default","itemLayout","dataSource","renderItem","item","Meta","avatar","antd_lib_avatar__WEBPACK_IMPORTED_MODULE_5___default","src","userImg","title","href","_","setStore","topicId","push","description","topicCreatedTime","antd_lib_comment__WEBPACK_IMPORTED_MODULE_1___default","alt","userName","content","textAlign","BaseComponent"],"mappings":"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","file":"static/js/14.898c5145.chunk.js","sourcesContent":["import React from 'react';\r\nimport {connect} from 'dva';\r\nimport {Layout, Icon, Menu, message, Comment, Avatar, List, Divider, Form, Input, Button} from 'antd';\r\nimport BaseComponent from 'components/BaseComponent';\r\nimport $$ from 'cmn-utils'\r\nimport './index.less'\r\nimport {enquireIsMobile} from '@/utils/enquireScreen';\r\n\r\nconst {Header, Content, Footer, Sider} = Layout;\r\nconst TextArea = Input.TextArea\r\n//定义发布主题的UI\r\nconst Editor = ({\r\n                  onChange, onSubmit, submitting, value,\r\n                }) => (\r\n  <div>\r\n    <Form.Item>\r\n      <TextArea rows={4} onChange={onChange} value={value}/>\r\n    </Form.Item>\r\n    <Form.Item>\r\n      <Button\r\n        htmlType=\"submit\"\r\n        loading={submitting}\r\n        onClick={onSubmit}\r\n        type=\"primary\"\r\n        style={{float: 'right'}}\r\n      >\r\n        添加留言\r\n      </Button>\r\n    </Form.Item>\r\n  </div>\r\n)\r\n\r\n@connect()  //dva connect\r\nexport default class PerComment extends BaseComponent {\r\n  state = {\r\n    commentInfo: [],\r\n    visible: false,\r\n    submitting: false,\r\n    value: '',\r\n    isMobile: false\r\n  }\r\n\r\n  componentDidMount = () => {\r\n    this.judgeIsMobile()\r\n    this.getComment()\r\n  }\r\n\r\n  //判断是否是手机\r\n  judgeIsMobile = () => {\r\n    this.unregisterEnquire = enquireIsMobile(ismobile => {\r\n      const {isMobile} = this.state;\r\n      if (isMobile !== ismobile) {\r\n        this.setState({\r\n          isMobile: ismobile\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  //获取指定课程评论\r\n  getComment() {\r\n    $$.get(`http://192.168.43.191:8010/api/topic/queryByPerCourseId/${$$.getStore('perCourseId')}`)\r\n      .then(resp =>\r\n        this.setState({\r\n          commentInfo: resp.data\r\n        })).catch(e => console.log(e))\r\n  }\r\n\r\n  //返回课程详情页\r\n  goBack = () => {\r\n    this.history.replace('/column/intro')\r\n  }\r\n\r\n  //新建课程评论\r\n  addTopic = () => {\r\n    let data = {\r\n      topicPercourseId: $$.getStore('perCourseId'),\r\n      topicContent: this.state.value\r\n    }\r\n    $$.post(`http://192.168.43.191:8010/api/topic/publicTopic`, data).then(\r\n      resp => {\r\n        if (resp.icon === 'success') {\r\n          message.success(resp.message)\r\n        } else {\r\n          message.error(resp.message)\r\n        }\r\n      }\r\n    )\r\n  }\r\n\r\n  //按钮点击回调\r\n  handleClick = () => {\r\n    this.setState({visible: true})\r\n  }\r\n  //关闭回复\r\n  closeComment = () => {\r\n    this.setState({visible: false})\r\n  }\r\n  //提交评论\r\n  handleSubmit = () => {\r\n    if (!this.state.value) {\r\n      return;\r\n    }\r\n    this.setState({\r\n      submitting: true,\r\n    });\r\n\r\n    //更新回复内容\r\n    this.addTopic()\r\n\r\n    setTimeout(() => {\r\n      this.setState({\r\n        submitting: false,\r\n        value: ''\r\n      })\r\n\r\n      this.getComment()\r\n      //关闭评论编辑框\r\n      this.closeComment(this)\r\n    }, 1000);\r\n  }\r\n\r\n  //提交修改\r\n  handleChange = (e) => {\r\n    this.setState({\r\n      value: e.target.value,\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const {commentInfo, submitting, value, visible, isMobile} = this.state\r\n\r\n    return (\r\n      <Layout className=\"full-layout per-comment-page\">\r\n        <Header style={{color: 'black'}}>\r\n          <Menu\r\n            theme=\"dark\"\r\n            mode=\"horizontal\"\r\n            style={{lineHeight: '64px'}}\r\n          >\r\n            <Menu.Item>\r\n              <div onClick={this.goBack}>\r\n                <Icon type=\"arrow-left\"\r\n                      style={isMobile ? {color: 'white', fontSize: '25px', } :{color: 'white', fontSize: '25px', marginLeft: '50px', marginTop: '10px'}}/>\r\n                返回课程主页\r\n              </div>\r\n            </Menu.Item>\r\n          </Menu>\r\n        </Header>\r\n        <Content style={{padding: '20px 50px'}}>\r\n          <div>\r\n            {commentInfo === null ? <div style={{marginLeft: '20px'}}>暂时没有评论</div> :\r\n              <List\r\n                itemLayout='horizontal'\r\n                dataSource={commentInfo}\r\n                renderItem={item => (\r\n                  <List.Item>\r\n                    <List.Item.Meta\r\n                      avatar={<Avatar\r\n                        src={item.userImg}/>}\r\n                      title={\r\n                        <a href=\"javascript:;\" onClick={_ => {\r\n                          $$.setStore('topicId', item.topicId)\r\n                          $$.setStore('beforeUrl', '/column/per/comment')\r\n                          this.history.push('/column/per/community/intro')\r\n                        }}>\r\n                          {item.topicContent}\r\n                        </a>\r\n                      }\r\n                      description={item.topicCreatedTime}\r\n                    />\r\n                  </List.Item>\r\n                )}\r\n              />\r\n            }\r\n            {visible &&\r\n            <Comment\r\n              avatar={(\r\n                <Avatar\r\n                  src={$$.getStore('user').userImg}\r\n                  alt={$$.getStore('user').userName}\r\n                />\r\n              )}\r\n              content={(\r\n                <Editor\r\n                  onChange={this.handleChange}\r\n                  onSubmit={this.handleSubmit}\r\n                  submitting={submitting}\r\n                  value={value}\r\n                />\r\n              )}\r\n            />\r\n            }\r\n            <Button type=\"primary\" icon='plus' style={{marginTop: '40px'}} onClick={this.handleClick}>\r\n              发布课程留言\r\n            </Button>\r\n          </div>\r\n        </Content>\r\n        <Footer style={{textAlign: 'center'}}></Footer>\r\n      </Layout>\r\n    );\r\n  }\r\n}\r\n"],"sourceRoot":""}
{"version":3,"sources":["routes/Community/TopicIntro/components/index.js"],"names":["Header","Content","TextArea","antd_lib_input__WEBPACK_IMPORTED_MODULE_23___default","a","Editor","_ref","onChange","onSubmit","submitting","value","react__WEBPACK_IMPORTED_MODULE_26___default","createElement","antd_lib_form__WEBPACK_IMPORTED_MODULE_21___default","Item","rows","antd_lib_button__WEBPACK_IMPORTED_MODULE_19___default","htmlType","loading","onClick","type","style","float","TopicIntro","connect","_ref2","topicIntro","models","state","visible","comments","isMobile","componentDidMount","_this","getOneComment","judgeIsMobile","unregisterEnquire","enquireIsMobile","ismobile","setState","props","dispatch","afterResponse","resp","data","payload","valueField","method","url","concat","$$","getStore","addComment","icon","antd_lib_message__WEBPACK_IMPORTED_MODULE_11___default","success","message","erro","replyTopicId","replyUserId","userId","replyContent","goBack","history","push","replyComment","closeComment","handleSubmit","setTimeout","Object","D_reactProject_itsp_tmp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_17__","handleChange","e","target","_this$state","this","topicDetail","antd_lib_layout__WEBPACK_IMPORTED_MODULE_25___default","className","color","antd_lib_menu__WEBPACK_IMPORTED_MODULE_7___default","theme","mode","lineHeight","antd_lib_icon__WEBPACK_IMPORTED_MODULE_9___default","fontSize","marginLeft","marginTop","padding","antd_lib_comment__WEBPACK_IMPORTED_MODULE_3___default","actions","author","topicUserId","avatar","antd_lib_avatar__WEBPACK_IMPORTED_MODULE_5___default","src","userImg","content","topicContent","datetime","topicCreatedTime","antd_lib_list__WEBPACK_IMPORTED_MODULE_1___default","dataSource","replyList","itemLayout","renderItem","item","replyCreatedTime","borderBottom","alt","BaseComponent"],"mappings":"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","file":"static/js/32.664a53ec.chunk.js","sourcesContent":["import React from 'react';\nimport {connect} from 'dva';\nimport {Avatar, Form, Comment, Icon, Layout, List, Menu, Button, Input, message} from 'antd';\nimport BaseComponent from 'components/BaseComponent'\nimport {enquireIsMobile} from '@/utils/enquireScreen';\nimport $$ from 'cmn-utils'\n\nconst {Header, Content} = Layout;\nconst TextArea = Input.TextArea\n\n//定义添加回复UI\nconst Editor = ({\n                  onChange, onSubmit, submitting, value,\n                }) => (\n  <div>\n    <Form.Item>\n      <TextArea rows={4} onChange={onChange} value={value}/>\n    </Form.Item>\n    <Form.Item>\n      <Button\n        htmlType=\"submit\"\n        loading={submitting}\n        onClick={onSubmit}\n        type=\"primary\"\n        style={{float: 'right'}}\n      >\n        添加留言\n      </Button>\n    </Form.Item>\n  </div>\n)\n\n@connect(({topicIntro, loading}) => ({\n  topicIntro,\n  loading: loading.models.topicIntro\n}))\nexport default class TopicIntro extends BaseComponent {\n\n  state = {\n    visible: false,\n    comments: [],\n    submitting: false,\n    value: '',\n    isMobile: false\n  }\n\n  componentDidMount = () => {\n    this.getOneComment()\n    this.judgeIsMobile()\n  }\n\n  //判断是否是手机\n  judgeIsMobile = () => {\n    this.unregisterEnquire = enquireIsMobile(ismobile => {\n      const {isMobile} = this.state;\n      if (isMobile !== ismobile) {\n        this.setState({\n          isMobile: ismobile\n        });\n      }\n    });\n  }\n\n  //获取指定的评论信息\n  getOneComment = () => {\n    this.props.dispatch({\n      type: 'topicIntro/@request',\n      afterResponse: resp => resp.data,\n      payload: {\n        valueField: 'topicDetail',\n        method: 'GET',\n        url: `http://59.67.107.169:8010/api/topic/queryTopic/${$$.getStore('topicId')}`\n      }\n    })\n  }\n\n  //添加回复内容\n  addComment = () => {\n    this.props.dispatch({\n      type: 'topicIntro/@request',\n      afterResponse: resp => {\n        if (resp.icon === 'success') {\n          message.success(resp.message)\n        } else {\n          message.erro(resp.message)\n        }\n      },\n      payload: {\n        method: 'POST',\n        url: `http://59.67.107.169:8010/api/reply/publicReply`,\n        data: {\n          replyTopicId: $$.getStore('topicId'),\n          replyUserId: $$.getStore('user').userId,\n          replyContent: this.state.value\n        }\n      }\n    })\n  }\n\n  //返回\n  goBack = () => {\n    this.history.push($$.getStore('beforeUrl'))\n  }\n  //回复评论\n  replyComment = () => {\n    this.setState({\n      visible: true\n    })\n  }\n\n  //关闭回复\n  closeComment = () => {\n    this.setState({visible: false})\n  }\n  //提交评论\n  handleSubmit = () => {\n    if (!this.state.value) {\n      return;\n    }\n\n    this.setState({\n      submitting: true,\n    });\n\n    //更新回复内容\n    this.addComment()\n\n    setTimeout(() => {\n      this.setState({\n        submitting: false,\n        value: ''\n      })\n      this.getOneComment()\n      //关闭评论编辑框\n      this.closeComment(this)\n    }, 1000);\n  }\n\n  //提交修改\n  handleChange = (e) => {\n    this.setState({\n      value: e.target.value,\n    });\n  }\n\n  render() {\n    const {visible, comments, submitting, value, isMobile} = this.state\n    const {topicDetail} = this.props.topicIntro\n    return (\n      <Layout className=\"full-layout topic-intro-page\">\n        <Header style={{color: 'black'}}>\n          <Menu\n            theme=\"dark\"\n            mode=\"horizontal\"\n            style={{lineHeight: '64px'}}\n          >\n            <Menu.Item>\n              <div onClick={this.goBack}>\n                <Icon type=\"arrow-left\"\n                      style={isMobile ? {color: 'white', fontSize: '25px', } :{color: 'white', fontSize: '25px', marginLeft: '50px', marginTop: '10px'}}/>\n                返回评论主页\n              </div>\n            </Menu.Item>\n          </Menu>\n        </Header>\n        <Content style={{padding: '20px 50px'}}>\n          <Comment\n            className=\"comment-topic\"\n            actions={[<div onClick={this.replyComment}>回复</div>]}\n            author={topicDetail.topicUserId}\n            avatar={(\n              <Avatar\n                src={topicDetail.userImg}\n              />)}\n            content={topicDetail.topicContent}\n            datetime={topicDetail.topicCreatedTime}\n          >\n            <div>\n              <List\n                dataSource={topicDetail.replyList}\n                itemLayout=\"horizontal\"\n                className=\"comment-list\"\n                renderItem={item => (\n                  <Comment\n                    // actions={[<div onClick={this.openComment}>回复</div>]}\n                    author={item.replyUserId}\n                    avatar={(\n                      <Avatar\n                        src={item.userImg}\n                      />)}\n                    content={item.replyContent}\n                    datetime={item.replyCreatedTime}\n                    style={{borderBottom: '1px solid #e2e2e2'}}\n                  />\n                )}\n              />\n              {visible &&\n                <Comment\n                  avatar={(\n                    <Avatar\n                      src=\"http://localhost:8010/file/icon1.jpeg\"\n                      alt=\"Shang Yuxiu\"\n                    />\n                  )}\n                  content={(\n                    <Editor\n                      onChange={this.handleChange}\n                      onSubmit={this.handleSubmit}\n                      submitting={submitting}\n                      value={value}\n                    />\n                  )}\n                />\n              }\n            </div>\n          </Comment>\n        </Content>\n      </Layout>\n    );\n  }\n}\n"],"sourceRoot":""}